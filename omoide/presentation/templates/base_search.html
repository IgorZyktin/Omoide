<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <link rel="shortcut icon"
          href="{{ url_for('static', path='favicon.ico') }}">
    <link type="text/css"
          href="{{ url_for('static', path='styles.css') }}"
          rel="stylesheet">
    <script type="text/javascript"
            src="{{ url_for('static', path='code.js') }}"></script>
    {% block head %}{% endblock %}
    <title>Omoide</title>
</head>

<body>
<div id="header">
    <div class="query-container">
        <a href="{{ url_for('home') + aim.to_url() }}"
           title="Clear search query and show random items"
           class="button">
            <img src="{{ request.url_for('static', path='ic_home_24px.svg') }}"
                 class="invert"
                 alt="Home icon"/>
            <span class="wide-text">&nbsp;Home</span>
        </a>

        <label for="query">
            <input id="query_element"
                   name="query"
                   type="search"
                   value="{{ query.query.raw_query if query else '' }}"
                   class="query_input"
                   placeholder="Enter one or more tags here" autofocus/>
        </label>

        <a href="javascript:void(0)"
           title="Press to perform search"
           onclick="goSearch()"
           class="button">
            <img src="{{ request.url_for('static', path='ic_search_24px.svg') }}"
                 class="invert"
                 alt="Looking glass icon"/>
            <span class="wide-text">&nbsp;Search</span>
        </a>

        <a href="javascript:void(0)"
           title="Toggle random"
           onclick="toggleOrdered()"
           class="button{{ ' active-button' if aim.ordered else '' }}">
            <img src="{{ request.url_for('static', path='ic_sort_24px.svg') }}"
                 class="invert"
                 alt="Toggle ordered"/>
            <span class="wide-text">&nbsp;Ordered</span>
        </a>

        <a href="javascript:void(0)"
           title="Toggle nested"
           onclick="toggleNested()"
           class="button{{ ' active-button' if aim.nested else '' }}">
            <img src="{{ request.url_for('static', path='ic_device_hub_24px.svg') }}"
                 class="invert"
                 alt="Toggle nested"/>
            <span class="wide-text">&nbsp;Nested</span>
        </a>

        {% if block_paginated %}
            <span class="button-disabled">
                <img src="{{ request.url_for('static', path='ic_import_contacts_24px.svg') }}"
                     class="invert"
                     alt="Toggle paged"/>
                <span class="wide-text">&nbsp;Paged</span>
            </span>
        {% else %}
            <a href="javascript:void(0)"
               title="Toggle paged"
               onclick="togglePaged()"
               class="button{{ ' active-button' if aim.paged else '' }}">
                <img src="{{ request.url_for('static', path='ic_import_contacts_24px.svg') }}"
                     class="invert"
                     alt="Toggle paged"/>
                <span class="wide-text">&nbsp;Paged</span>
            </a>
        {% endif %}

        {% if user.is_anon() %}
            <a href="{{ url_for('login') }}"
               title="Log in"
               class="button">
                <img src="{{ request.url_for('static', path='ic_perm_identity_24px.svg') }}"
                     class="invert"
                     alt="Log in icon"/>
                <span class="wide-text">&nbsp;Login</span>
            </a>
        {% else %}
            <a href="{{ url_for('profile') }}"
               title="Enter user profile"
               class="button">
                <img src="{{ request.url_for('static', path='ic_perm_identity_24px.svg') }}"
                     class="invert"
                     alt="Profile icon"/>
                <span class="wide-text">&nbsp;{{ user.name }}</span>
            </a>
        {% endif %}
    </div>

    {% if not user.is_anon() %}
        <div class="menu-container">
            {% if current_item %}
                {% set parent_hint = '?parent_uuid=' + current_item.uuid|string %}
            {% else %}
                {% set parent_hint = '' %}
            {% endif %}

            <a href="{{ url_for('create_item') + parent_hint }}"
               title="Create new item"
               class="button">
                <img src="{{ request.url_for('static', path='ic_create_new_folder_24px.svg') }}"
                     class="invert"
                     alt="Create new item"/>
                <span class="wide-text">&nbsp;Create item</span>
            </a>

            <a href="{{ url_for('upload') + parent_hint }}"
               title="Upload media"
               class="button">
                <img src="{{ request.url_for('static', path='ic_perm_media_24px.svg') }}"
                     class="invert"
                     alt="Upload media"/>
                <span class="wide-text">&nbsp;Upload media</span>
            </a>

            {% if current_item and current_item.owner_uuid == user.uuid %}
                <a href="{{ url_for('upload') + parent_hint }}"
                   title="Edit item"
                   class="button">
                    <img src="{{ request.url_for('static', path='ic_format_list_bulleted_24px.svg') }}"
                         class="invert"
                         alt="Edit item"/>
                    <span class="wide-text">&nbsp;Edit item</span>
                </a>

                <a href="{{ url_for('app_delete_item', uuid=current_item.uuid) }}"
                   title="Delete item"
                   class="button">
                    <img src="{{ request.url_for('static', path='ic_delete_24px.svg') }}"
                         class="invert"
                         alt="Delete item"/>
                    <span class="wide-text">&nbsp;Delete item</span>
                </a>
            {% else %}
                <span class="button-disabled">
                    <img src="{{ request.url_for('static', path='ic_format_list_bulleted_24px.svg') }}"
                         class="invert"
                         alt="Edit item"/>
                    <span class="wide-text">&nbsp;Edit item</span>
                </span>

                <span class="button-disabled">
                    <img src="{{ request.url_for('static', path='ic_delete_24px.svg') }}"
                         class="invert"
                         alt="Delete item"/>
                    <span class="wide-text">&nbsp;Delete item</span>
                </span>
            {% endif %}
        </div>
    {% endif %}

    {% block upper_body %}{% endblock %}

</div>

{% block body %}{% endblock %}
<script>
    document.addEventListener('keydown', function (event) {
        if (event.key === 'Enter'
            && ['/search',
                '/browse',
                '/preview'].includes(window.location.pathname)) {
            goSearch()
        }
    });
</script>

{%- if config.omoide_injection %}
    {{ config.omoide_injection|safe }}
{% endif -%}

</body>
</html>
