<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <link rel="shortcut icon"
          href="{{ url_for('static', path='favicon.ico') }}">
    <link type="text/css"
          href="{{ url_for('static', path='styles.css') }}"
          rel="stylesheet">
    <script type="text/javascript"
            src="{{ url_for('static', path='code.js') }}"></script>
    <script type="text/javascript"
            src="{{ url_for('static', path='thirdparty/jquery-3.6.0.min.js') }}"></script>
    {% block head %}{% endblock %}
    <title>Omoide</title>
    {%- if config.injection %}
        {{ config.injection|safe }}
    {% endif -%}
</head>

<body>
<div id="header">
    <div class="query-container">
        <a href="{{ url_for('app_home') + aim.to_url() | safe }}"
           title="Clear search query and show random items"
           class="button">
            <img src="{{ request.url_for('static', path='ic_home_24px.svg') }}"
                 class="invert"
                 alt="Home icon"/>
            <span class="wide-text">&nbsp;Home</span>
        </a>

        <label for="query">
            <input id="query_element"
                   name="query"
                   type="search"
                   value="{{ query.query.raw_query if query else '' }}"
                   class="query_input"
                   placeholder="Enter one or more tags here" autofocus/>
        </label>

        <a href="javascript:void(0)"
           title="Press to perform search"
           onclick="goSearch()"
           class="button">
            <img src="{{ request.url_for('static', path='ic_search_24px.svg') }}"
                 class="invert"
                 alt="Looking glass icon"/>
            <span class="wide-text">&nbsp;Search</span>
        </a>

        {% if block_ordered or False %}
            <span class="button-disabled">
                {% if aim.ordered %}
                    <img src="{{ request.url_for('static', path='ic_sort_24px.svg') }}"
                         class="invert"
                         alt="Ordering is not supported in this section"/>
                    <span class="wide-text">&nbsp;Ordered</span>
                {% else %}
                    <img src="{{ request.url_for('static', path='ic_random_24px.svg') }}"
                         class="invert"
                         alt="Ordering is not supported in this section"/>
                    <span class="wide-text">&nbsp;Random</span>
                {% endif %}
            </span>
        {% else %}
            {% if aim.ordered %}
                <a href="javascript:void(0)"
                   title="Show items ordered"
                   onclick="toggleOrdered()"
                   class="button">
                    <img src="{{ request.url_for('static', path='ic_sort_24px.svg') }}"
                         class="invert"
                         alt="Show items ordered"/>
                    <span class="wide-text">&nbsp;Ordered</span>
                </a>
            {% else %}
                <a href="javascript:void(0)"
                   title="Show items in random order"
                   onclick="toggleOrdered()"
                   class="button">
                    <img src="{{ request.url_for('static', path='ic_random_24px.svg') }}"
                         class="invert"
                         alt="Show items in random order"/>
                    <span class="wide-text">&nbsp;Random</span>
                </a>
            {% endif %}
        {% endif %}

        {% if block_nested or False %}
            <span class="button-disabled">
                {% if aim.nested %}
                    <img src="{{ request.url_for('static', path='ic_nested_on.svg') }}"
                         class="invert"
                         alt="Nesting is not supported in this section"/>
                    <span class="wide-text">&nbsp;Nested</span>
                {% else %}
                    <img src="{{ request.url_for('static', path='ic_nested_off.svg') }}"
                         class="invert"
                         alt="Nesting is not supported in this section"/>
                    <span class="wide-text">&nbsp;Flat</span>
                {% endif %}
            </span>
        {% else %}
            {% if aim.nested %}
                <a href="javascript:void(0)"
                   title="Show only top level items"
                   onclick="toggleNested()"
                   class="button">
                    <img src="{{ request.url_for('static', path='ic_nested_on.svg') }}"
                         class="invert"
                         alt="Show only top level items"/>
                    <span class="wide-text">&nbsp;Nested</span>
                </a>
            {% else %}
                <a href="javascript:void(0)"
                   title="Show albums same way as separate pages"
                   onclick="toggleNested()"
                   class="button">
                    <img src="{{ request.url_for('static', path='ic_nested_off.svg') }}"
                         class="invert"
                         alt="Show albums same way as separate pages"/>
                    <span class="wide-text">&nbsp;Flat</span>
                </a>
            {% endif %}
        {% endif %}

        {% if block_paginated or False %}
            <span class="button-disabled">
                <img src="{{ request.url_for('static', path='ic_paginated_on.svg') }}"
                     class="invert"
                     alt="Pagination is not supported in this section"/>
                {% if aim.paged %}
                    <span class="wide-text">&nbsp;Paginated</span>
                {% else %}
                    <span class="wide-text">&nbsp;Dynamic</span>
                {% endif %}
            </span>
        {% else %}
            {% if aim.paged %}
                <a href="javascript:void(0)"
                   title="Show items in statically rendered pages"
                   onclick="togglePaged()"
                   class="button">
                    <img src="{{ request.url_for('static', path='ic_paginated_on.svg') }}"
                         class="invert"
                         alt="Show items in statically rendered pages"/>
                    <span class="wide-text">&nbsp;Paginated</span>
                </a>
            {% else %}
                <a href="javascript:void(0)"
                   title="Load items dynamically"
                   onclick="togglePaged()"
                   class="button">
                    <img src="{{ request.url_for('static', path='ic_paginated_off.svg') }}"
                         class="invert"
                         alt="Load items dynamically"/>
                    <span class="wide-text">&nbsp;Dynamic</span>
                </a>
            {% endif %}
        {% endif %}

        {% if user.is_anon() %}
            <a href="{{ url_for('app_login') }}"
               title="Log in"
               class="button">
                <img src="{{ request.url_for('static', path='ic_perm_identity_24px.svg') }}"
                     class="invert"
                     alt="Log in icon"/>
                <span class="wide-text">&nbsp;Login</span>
            </a>
        {% else %}
            <a href="{{ url_for('app_profile') }}"
               title="Enter user profile"
               class="button">
                <img src="{{ request.url_for('static', path='ic_perm_identity_24px.svg') }}"
                     class="invert"
                     alt="Profile icon"/>
                <span class="wide-text">&nbsp;{{ user.name }}</span>
            </a>
        {% endif %}
    </div>

    {% if not user.is_anon() %}
        <div class="menu-container">
            {% if current_item %}
                {% set parent_hint = '?parent_uuid=' + current_item.uuid|string %}
            {% else %}
                {% set parent_hint = '' %}
            {% endif %}

            <a href="{{ url_for('app_item_create') + parent_hint }}"
               title="Create new item"
               class="button">
                <img src="{{ request.url_for('static', path='ic_create_new_folder_24px.svg') }}"
                     class="invert"
                     alt="Create new item"/>
                <span class="wide-text">&nbsp;Create item</span>
            </a>

            <a href="{{ url_for('upload') + parent_hint }}"
               title="Upload media"
               class="button">
                <img src="{{ request.url_for('static', path='ic_perm_media_24px.svg') }}"
                     class="invert"
                     alt="Upload media"/>
                <span class="wide-text">&nbsp;Upload media</span>
            </a>

            {% if current_item and current_item.owner_uuid|string == user.uuid|string %}
                <a href="{{ url_for('app_item_update', uuid=current_item.uuid) }}"
                   title="Edit item"
                   class="button">
                    <img src="{{ request.url_for('static', path='ic_format_list_bulleted_24px.svg') }}"
                         class="invert"
                         alt="Edit item"/>
                    <span class="wide-text">&nbsp;Edit item</span>
                </a>

                <a href="{{ url_for('app_item_delete', uuid=current_item.uuid) }}"
                   title="Delete item"
                   class="button">
                    <img src="{{ request.url_for('static', path='ic_delete_24px.svg') }}"
                         class="invert"
                         alt="Delete item"/>
                    <span class="wide-text">&nbsp;Delete item</span>
                </a>
            {% endif %}
        </div>
    {% endif %}

    {% block upper_body %}{% endblock %}

</div>

{% block body %}{% endblock %}
<script>
    document.addEventListener('keydown', function (event) {
        if (event.key === 'Enter'
            && ['/search',
                '/browse',
                '/preview'].includes(window.location.pathname)) {
            goSearch()
        }
    });
</script>

</body>
</html>
