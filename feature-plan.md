# План по доработкам

## Корневые записи

Надо каждому пользователю создать корневой item, от которого будет
наследоваться вся коллекция пользователя. Это позволит отказаться от
обработчиков вида by_user и пользоваться только browse.

## Режимы просмотра

Надо добавить для переключателя: nested/flat и ordered/random. Они будут
использоваться в обработчике browse и позволят переключать режимы отображения.

Первый будет отвечать за вывод вложенных сущностей. В режиме nested при
просмотре записей буду выводиться только прямые потомки. Это примерно
аналогично просмотру по каталогам в обычном проводнике. Соответственно в режиме
flat будут выводиться не только прямые потомки, но и вообще любой уровень
вложенности. Т.е. при просмотре фотоальбомов их обложки будут выводиться вместе
с содержимым.

Второй будет влиять на порядок вывода элементов, соответственно случайный или
упорядоченный.

Система Omoide изначально запланирована для просмотра больших объёмов
накопленных данных, возможно вообще без цели что-то найти. Например, чтобы
понимать, что за данные у нас вообще есть. Возможно случайно увидеть что-то
интересное и уже начать поиск отталкиваясь от этой записи.

Оба режима предполагают динамическую подгрузку записей клиентом, без их
предварительного рендеринга. Для обеспечения этого надо будет отказаться от
пагинации в режиме упорядоченного просмотра. Предполагается, что записей
верхнего уровня не так уж много, поэтому проблемы быть не должно. Пагинация
останется только при просмотре конкретных альбомов и при явном поиске по тегам.

Это решит проблему с тем, что сейчас by_user и browse показывают одни и те же
записи разным образом. Останется только browse, который можно будет настроить
оптимальным образом.

Следует помнить, что работать это должно как для зарегистрированных
пользователей, так и для анонимусов. Так что стоит избегать здесь работы с
базой данных и обходиться только параметрами в url.
